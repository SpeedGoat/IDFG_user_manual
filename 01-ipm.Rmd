---
title: "IPM"
---

# IPM {#ipm}

An Integrated Population Model(IPM), jointly analyzes data on population size and demographic parameters. Data collected in the field inform the demographic parameters in the model and unifying the analyses of multiple sources of data. The outputs from survival models and sightability models run in the PopR website and harvest data from the IDFG database are used as data in the IDFG IPM. The IPM analyzes populations at the [<b>DAU</b>]{style="color: #086e04;"} level.

## Walkthrough {#ipm-model}

Using the IPM tool can be split into two major processes: fitting the IPM and reviewing the estimates.

### Fiting the IPM {#ipm-load}

Click on the Setup tab, the first dropdown under the IPM tool menu.

<center>![](./www/ipm_walk1.png)</center>

On the top left of the page is a window labeled Overview, and this is where you determine the data used in the IPM. Select the Species, [<b>DAU</b>]{style="color: #086e04;"}, DAU, and Unit(if the species selected allows analysis at the unit level) you want to analyze. Next, select the IPM Database that contains the demographic data you want to use for the analysis. If you want to predict juvenile survival under different weather scenarios, select the prefered Future Weather, otherwise leave this at the default.  To upload harvest data from the IDFG harvest database click [<b>Fetch Harvest Data</b>]{style="color: #196eb0;"}.

<center>![](./www/ipm_walk2.png)</center>

Once the harvest data is loaded, you will get a popup dialog letting you know that the process was successful. It will also prompt you to proceed to the "Structure" tab (At the top left of the page next to the Overview tab), to select the structure of the population model.

You can view the downloaded harvest data and demographic data present in the selected IPM database in tabular form below the setup panel, or in plots to the right. Please check to make sure the data you expect to be present is available in the database you selected and gut check the harvest data as this is pulled straight from the IDFG harvest database. IF an abundance or composition survey is not present in the data, you may need to go to the sightability tab to analyze a survey or if the data has not been entered, you may need to enter it in the Data Entry Tab prior to running the sightability or composition analysis. (May be benefical to add an image here)

The Structure tab allows you to select the structure of survival and reproduction in the population model. The time varying option allows the parameter of interest to vary annually and the constant option holds the parameter of interest constant. The defaults represent the life history speed and biology of the species selected, and we suggest clicking [<b>"Default Structure"</b>]{style="color: #196eb0;"} to set to the species default. Often the inputs that appear when the tool is opened are actually not the same as those that are selected when you press [<b>"Default Structure"</b>]{style="color: #196eb0;"}, so make sure you click that before you move on to Harvest if those are the inputs you are planning to use.

<center>![](./www/ipm_walk4.png)</center>

After you select your Structure, you can move on to the Harvest Tab. If using population reconstruction, the harvest tab allows you to select the effort variable used to model harvest mortality. Select the effort variable that best describes an individuals risk of harvest in the area being modeled. If you decide to predict the population past the last year of data, you can specify level of harvest for each year into the future to assess how changes in harvest management will affect the population trajectory, survival, and harvest rate. You can change the Harvest by double clicking the numbers and typing in new entries. 

<center>![](./www/ipm_walk5.png)</center>

Our next step is to set the length of time you want to run the model. The run tab allows you to select the Burnin Lenght - the number of times values are tried by the model, the MCMC iterations- the number of iterations to save for plotting after burnin is reached, and thinning- the number of values to save each time values are selected to fit the model. The default values provided are often a good starting point, however, if the models are not converging, maximizing the Burnin can help with model convergence. If maximizing the burnin is unsuccessful, you can check automate convergence which will run the model until convergence is reached. As a warning this may take a long time.

<center>![](./www/ipm_walk6.png)</center>

Once you are satisfied with all of the inputs outlined above, click [<b>Fit Model</b>]{style="color: #196eb0;"} to begin analysis. This should take some time, but you will get a dialog box letting you know when the process is complete. While the model is running, the website will not perform operations if you attempt to explore different plots or tabs.

### Reviewing the Results {#ipm-look}

(NOTE: This section will only work if you completed the steps above to prepare your data and fit your model beforehand.)

To view the results of the IPM, wait until the model has finished running, then click the Plots tab on the IPM dropdown menu to check the results. Hovering your mouse over the lines in each plot will allow you to view the parameter estimates from the model, and hovering over the points allows you to view the observational data used as inputs to the model to inform the parameter.

<center>![](./www/ipm_walk7.png)</center>

You can also view the model output by clicking the Tables tab right below the Plots tab on the IPM dropdown. You can navigate the results by filtering within a column, view more results by selecting [<b>Show (10) Entries</b>]{style="color: #196eb0;"} at the top left of the page, or copy, print, or download the visible results using the associated buttons in the topright. 

Model diagnostics. One way to determine if the model fit correctly is to assess model convergence. Rhat values are a measure of how well the model greater than 1.1 are highlighted in red, which means the model may not have converged and should be run again after increasing the Burnin length in Run tab in the Setup tool. 

<center>![](./www/ipm_walk8.png)</center>

As a final step to get more diagnostic information, use the Build Report tool. 

<center>![](./www/ipm_walk10.png)</center>

Simply click on the tool and then click the download prompt on the popup window. The resulting document contains interactive plots as well as model specifications and fit.

<center>![](./www/ipm_walk9.png)</center>

## Reference {#ipm-ref}

### Setup {#ipm-setup}

The main purpose of the Setup tab is to load and preview data that will be used for later analysis, and we will spend more time describing each element in detail. The window on the top left of the page has several tabs related to data preparation labeled Overview, Structure, Harvest, and Run.

The Overview tab helps you find the data you will be loading for your IPM. Make sure that you are pulling from the correct database! Also, the Future Weather dropdown allows you to consider weather in your IPM analysis. Average assumes mean observed weather conditions, Good assumes upper 95% quantile of observed weather, and Bad assumes lower 5% quantile of observed weather. You may also choose not to include weather in your analysis. All of these values were developed from the dissertation of Mark Hurley.

The Structure tab gives our model some information about assumptions. Population reconstruction is the process of estimating past abundance using a combination of known harvest data and estimated natural mortality rates. If you know when an animal died AND how old it was when it died, then you also know when it was alive. Using this "back-tracking" can create an abundance estimate for past years even if one was not carried out.

The Harvest tab gives our model some important context on harvest metrics. The slider at the top tells our model which years are being analyzed. The effort variable allows us to choose whether effort is determined by the number of days in the field or the number of hunters themselves. It also gives more context to our harvest numbers and helps us tease apart the relationship that hunter effectiveness and raw number of hunters had on the harvest that year. You may also give hypothetical harvest numbers for our model to consider so you may estimate the effects of management decisions on rates like survival and abundance.

The Run tab gives direction to our actual modeling process. The given settings control how we deal with the many thousands of times the model must run to calibrate itself. Burnin Length helps us focus our model. When the MCMC model begins running, it checks possible outputs of the model and begins sampling them to determine the probability that they will represent our data. The model uses past sampled points to try and get an idea of where the highest probabilities are, but when the model first begins running it does not have the luxury of these reference points. This sets up the model's first few samples to be more randomly chosen than any part of the process, meaning that the beginning samples are less likely to be on high probability outputs. Burnin Length helps us get around this by deleting the first runs of the MCMC model after it's done running. MCMC iterations is simply a measure of how many different times the model will test the probability of different model outputs. More sampling allows the model to consider more options and therefore can increase the chance that the model will find the outputs with the highest likelihoods, but it also may not be necessary and will make the tool take longer to run. Thinning rate helps us save memory by deleting entries from the model's stored runs. We can think of this as a sort of browser history for the model, showing us how it got its answer. In this case there are literally tens of thousands of steps, so deleting a small (or large) proportion of that history and using what is left still gives us an idea of the model's actions without taking up nearly as much memory. The slider is the percentage of model iterations that will be deleted once the modeling process is complete.

The window on the top right of the page is for previewing data after it is loaded but before the model is run. Hovering your cursor over data points will give you all relevant data. You can change your view of the data using the pan and two zoom features on the side of each graph. Click the reset button to return to the original view. The table at the bottom of the page gives another way to preview the data you loaded in the Overview tab. You can organize your data by any of the column headers, and note that you can navigate and view more of your data with the previous and next buttons at the bottom of the page.

### Database Management {#ipm-dbmgmt}

The DB Mgmt tab creates, deletes and edits databases.The tools may be minimized, but to open them for use just click on the plus sign on the right side of the box containing the tool. Press it again to minimize it. Note that because databases are shared between users, edits here will change databases for EVERYONE. Data losses and changes will be permanent if you do not back up your data. You can also use the Create tab to make a new database.

You can enter your information manually using the blank table at the bottom of the tool window, but you may also paste data from a spreadsheet app like Excel. You can also start off with data from any existing database, which you can select under the Historic Data box. Make sure to give your new database a name, and then click the create database button to add a database to the Speedgoat server! You can also use the download tool to get the data you have loaded into our servers as a .csv.

The Delete DB tool will delete the database you select from the server. Deleting it here will delete it for everyone, so make sure that your data is backed up and that nobody is still working on a database before you delete it.

The Edit tool allows you to add and delete rows of data from the database selected in the menu at the top of the tool. None of the edits you make will be applied until the Save Changes button is clicked, but once that button is clicked changes will be applied for everyone that uses that database.

### Plots {#ipm-plot}

The plots page has graphs that are created by running your selected data through an IPM. Use the zoom and pan tools to change your view of the graph, and use the reset button to return to your original view.

### Tables {#ipm-table}

On the Tables page you can download and edit the data you are using for analysis. You can download your data here as well, but note that you will only download the data being displayed to you. By default, the table only shows the first ten entries of your dataset, so if you would like to download your data here make sure you change the dropdown at the top of the window from Show 10 entries to Show All entries.

### Build Report {#ipm-report}

The Build Report tool gives a summary of the analysis conducted, while keeping relevant information like model settings for future comparisons.
